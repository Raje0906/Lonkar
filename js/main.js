// Language translations object
const translations = {
    english: {
        // Header
        'college-name': 'LONKAR MADHYAMIK VIDYALAYA<br>& JUNIOR COLLEGE, MUNDHWA',
        'college-affiliation': '( Affiliated to Maharashtra State Board of Secondary & Higher Secondary Education )',
        'naac-grade': '"NAAC Grade A+"',
        'college-info-extra': 'Estd. 1971',
        
        // Navigation
        'nav-home': 'Home',
        'nav-about': 'About Us',
        'nav-academics': 'Academics',
        'nav-faculties': 'Faculties',
        'nav-gallery': 'Gallery',
        'nav-feedback': 'Feedback',
        
        // Left Sidebar
        'notice': 'Notice',
        'news': 'News',
        'calendar': 'Monthly Calendar',
        'events': 'Event',
        
        // Right Sidebar
        'about': 'About Us',
        'iqac': 'IQAC',
        'library': 'Library',
        'complaint': 'Complain',
        
        // Messages Section
        'messages-title': 'Messages from Officials',
        'president-name': 'Hon. Ajit dada Pawar',
        'president-title': 'President, PDEA, Pune.',
        'vice-president-name': 'HON.RAJENDRA GHADAGE',
        'vice-president-title': 'Vice - President, PDEA, Pune.',
        'secretary-name': 'Hon. Adv Sandeep Kadam',
        'secretary-title': 'Secretary, PDEA, Pune.',
        'principal-name': 'Dr. Nitin L. Ghorpade',
        'principal-title': 'Principal',

        // Donation Section
        'donation-title': 'Donation Appeal',
        'donation-text': '... We are reaching out to you on behalf of Lonkar Madhyamik Vidyalaya & Junior College, Mundhwa. Our institution has been serving the community since 1971, providing quality education to thousands of students. The overwhelming response from our local community has led to a continuous increase in our student enrollment. This growth puts natural pressure on our facilities and available space. To maintain our high standards of education and accommodate the growing number of students, we have decided to expand our infrastructure and enhance our facilities...',
        'donation-button-complete': 'Complete',
        'donation-button-pdf': 'Donation Appeal (PDF)',

        // Footer
        'contact-title': 'Contact Us',
        'college-contact-name': 'Lonkar Madhyamik Vidyalaya & Junior College',
        'address': '3, Mundhwa Rd, Lonkar Ali, Magarpatta, Mundhwa, Pune, Maharashtra 411036',
        'campus-video': 'Campus Video',
        'visitor-counter': 'Visitor Counter:',
        'campus-life': 'Campus Life',
        'map-location': 'Map Location',
        
        // Campus Life Links
        'academic-committees': 'College Academic Committees (updated on 15 sep 2024)',
        'rti': 'RTI',
        'grievance': 'Students\' Grievance Redressal cell',
        'nss': 'NSS',
        'ncc': 'NCC',
        'sports': 'Sports',
        'caste-committee': 'Prevention of Caste-based Discrimination Committee',
        
        // Language Button
        'lang-text': 'मराठी',
        'lang-title': 'मराठीत बदला'
    },
    marathi: {
        // Header
        'college-name': 'लोणकर माध्यमिक विद्यालय<br>आणि कनिष्ठ महाविद्यालय, मुंढवा',
        'college-affiliation': '(माध्यमिक व उच्च माध्यमिक शिक्षण मंडळ, महाराष्ट्र राज्य यांच्याशी संलग्न)',
        'naac-grade': '"नॅक ग्रेड A+"',
        'college-info-extra': 'स्थापना १९७१',
        
        // Navigation
        'nav-home': 'मुख्यपृष्ठ',
        'nav-about': 'आमच्याबद्दल',
        'nav-academics': 'शैक्षणिक',
        'nav-faculties': 'विभाग',
        'nav-gallery': 'गॅलरी',
        'nav-feedback': 'अभिप्राय',
        
        // Left Sidebar
        'notice': 'सूचना',
        'news': 'बातम्या',
        'calendar': 'मासिक दिनदर्शिका',
        'events': 'कार्यक्रम',
        
        // Right Sidebar
        'about': 'आमच्याबद्दल',
        'iqac': 'IQAC',
        'library': 'ग्रंथालय',
        'complaint': 'तक्रार',
        
        // Messages Section
        'messages-title': 'अधिकाऱ्यांचे संदेश',
        'president-name': 'मा. अजित दादा पवार',
        'president-title': 'अध्यक्ष, पीडीईए, पुणे',
        'vice-president-name': 'मा. राजेंद्र घाडगे',
        'vice-president-title': 'उपाध्यक्ष, पीडीईए, पुणे',
        'secretary-name': 'मा. ॲड. संदीप कदम',
        'secretary-title': 'सचिव, पीडीईए, पुणे',
        'principal-name': 'डॉ. नितीन एल. घोरपडे',
        'principal-title': 'प्राचार्य',

        // Donation Section
        'donation-title': 'देणगी आवाहन',
        'donation-text': '... आम्ही लोणकर माध्यमिक विद्यालय आणि कनिष्ठ महाविद्यालय, मुंढवा यांच्या वतीने आपल्याला संपर्क साधत आहोत. आमची संस्था १९७१ पासून हजारो विद्यार्थ्यांना दर्जेदार शिक्षण देत आहे. स्थानिक समाजाकडून मिळणाऱ्या उत्तम प्रतिसादामुळे आमच्या विद्यार्थी संख्येत सातत्याने वाढ होत आहे. या वाढीमुळे आमच्या सुविधा आणि उपलब्ध जागेवर स्वाभाविकपणे ताण येत आहे. शिक्षणाचा उच्च दर्जा कायम राखण्यासाठी आणि वाढत्या विद्यार्थी संख्येला सामावून घेण्यासाठी, आम्ही आमची पायाभूत सुविधा विस्तारित करण्याचा आणि सुविधा वाढवण्याचा निर्णय घेतला आहे...',
        'donation-button-complete': 'पूर्ण',
        'donation-button-pdf': 'देणगी आवाहन (PDF)',

        // Footer
        'contact-title': 'संपर्क',
        'college-contact-name': 'लोणकर माध्यमिक विद्यालय आणि कनिष्ठ महाविद्यालय',
        'address': '३, मुंढवा रोड, लोणकर आळी, मगरपट्टा, मुंढवा, पुणे, महाराष्ट्र ४११०३६',
        'campus-video': 'कॅम्पस व्हिडिओ',
        'visitor-counter': 'अभ्यागत संख्या:',
        'campus-life': 'परिसर जीवन',
        'map-location': 'नकाशा स्थान',
        
        // Campus Life Links
        'academic-committees': 'महाविद्यालयीन शैक्षणिक समित्या (१५ सप्टेंबर २०२४ रोजी अपडेट केले)',
        'rti': 'माहितीचा अधिकार',
        'grievance': 'विद्यार्थी तक्रार निवारण कक्ष',
        'nss': 'राष्ट्रीय सेवा योजना',
        'ncc': 'राष्ट्रीय छात्र सेना',
        'sports': 'क्रीडा',
        'caste-committee': 'जातीय भेदभाव प्रतिबंध समिती',
        
        // Language Button
        'lang-text': 'English',
        'lang-title': 'Switch to English'
    }
};

// Helper function to update element text
function updateElementText(selector, key) {
    const element = document.querySelector(selector);
    if (element && translations[currentLang][key]) {
        element.innerHTML = translations[currentLang][key];
    }
}

// Current language state and toggle function
let currentLang = localStorage.getItem('preferredLanguage') || 'english';

function toggleLanguage() {
    currentLang = currentLang === 'english' ? 'marathi' : 'english';
    
    try {
        // Update button
        const langText = document.querySelector('.lang-text');
        const button = document.querySelector('.lang-toggle-btn');
        if (langText && button) {
            langText.textContent = translations[currentLang]['lang-text'];
            button.title = translations[currentLang]['lang-title'];
        }
        
        // Update header
        const collegeNameEl = document.querySelector('.college-name');
        if (collegeNameEl) collegeNameEl.innerHTML = translations[currentLang]['college-name'];
        
        // Update elements with data-translate attribute
        document.querySelectorAll('[data-translate]').forEach(element => {
            const key = element.getAttribute('data-translate');
            if (translations[currentLang][key]) {
                if (element.tagName.toLowerCase() === 'input' || element.tagName.toLowerCase() === 'textarea') {
                    element.placeholder = translations[currentLang][key];
                } else {
                    element.innerHTML = translations[currentLang][key];
                }
            }
        });
        
        // Update all text content
        updateElementText('.college-affiliation', 'college-affiliation');
        updateElementText('.naac-grade', 'naac-grade');
        updateElementText('.college-info-extra', 'college-info-extra');
        
        // Update navigation
        document.querySelectorAll('.nav-links a').forEach((link, index) => {
            const keys = ['nav-home', 'nav-about', 'nav-academics', 'nav-faculties', 'nav-gallery', 'nav-feedback'];
            if (keys[index]) link.textContent = translations[currentLang][keys[index]];
        });
        
        // Update sidebars
        document.querySelectorAll('.left-menu a').forEach((link, index) => {
            const keys = ['notice', 'news', 'calendar', 'events'];
            if (keys[index]) link.textContent = translations[currentLang][keys[index]];
        });
        
        document.querySelectorAll('.right-menu a').forEach((link, index) => {
            const keys = ['about', 'iqac', 'library', 'complaint'];
            if (keys[index]) link.textContent = translations[currentLang][keys[index]];
        });
        
        // Update messages section
        document.querySelectorAll('.message-card').forEach((card, index) => {
            const nameKeys = ['president-name', 'vice-president-name', 'secretary-name', 'principal-name'];
            const titleKeys = ['president-title', 'vice-president-title', 'secretary-title', 'principal-title'];
            
            const nameEl = card.querySelector('h3');
            const titleEl = card.querySelector('.designation');
            
            if (nameEl && nameKeys[index]) nameEl.textContent = translations[currentLang][nameKeys[index]];
            if (titleEl && titleKeys[index]) titleEl.textContent = translations[currentLang][titleKeys[index]];
        });
        
        // Update donation section
        updateElementText('.donation-container h2', 'donation-title');
        updateElementText('.donation-text', 'donation-text');
        
        const donationButton = document.querySelector('.donation-button');
        if (donationButton) {
            donationButton.children[0].textContent = translations[currentLang]['donation-button-complete'];
            donationButton.children[1].textContent = translations[currentLang]['donation-button-pdf'];
        }
        
        // Update footer
        updateElementText('.footer-section h3:nth-of-type(1)', 'contact-title');
        updateElementText('.contact-details p:first-child', 'college-contact-name');
        
        const addressEl = document.querySelector('.contact-details p:nth-child(2)');
        if (addressEl) {
            addressEl.innerHTML = `<i class="fas fa-map-marker-alt"></i> ${translations[currentLang]['address']}`;
        }
        
        // Update campus life links
        document.querySelectorAll('.campus-links a').forEach((link, index) => {
            const keys = ['academic-committees', 'rti', 'grievance', 'nss', 'ncc', 'sports', 'caste-committee'];
            if (keys[index]) {
                link.innerHTML = `<i class="fas fa-chevron-right"></i> ${translations[currentLang][keys[index]]}`;
            }
        });
        
        // Update visitor counter
        const visitorCounter = document.querySelector('.visitor-counter p');
        if (visitorCounter) {
            const count = visitorCounter.textContent.match(/\d+/)[0];
            visitorCounter.textContent = `${translations[currentLang]['visitor-counter']} ${count}`;
        }
        
        // Store language preference
        localStorage.setItem('preferredLanguage', currentLang);
        
    } catch (error) {
        console.error('Error during language translation:', error);
    }
}

// Initialize language on page load
document.addEventListener('DOMContentLoaded', function() {
    if (currentLang !== 'english') {
        toggleLanguage();
    }
});

// Language Toggle Functionality
const langToggle = document.getElementById('langToggle');
let currentLang = 'en';

langToggle.addEventListener('click', () => {
    currentLang = currentLang === 'en' ? 'mr' : 'en';
    langToggle.classList.toggle('marathi');
    
    // Update all text content including college name
    document.querySelectorAll('[data-en]').forEach(element => {
        if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
            element.placeholder = element.getAttribute(`data-${currentLang}-placeholder`);
        } else if (element.tagName === 'OPTION') {
            element.textContent = element.getAttribute(`data-${currentLang}`);
        } else {
            element.textContent = element.getAttribute(`data-${currentLang}`);
        }
    });

    // Update HTML lang attribute
    document.documentElement.lang = currentLang;
});

// Mobile Menu Toggle
const mobileMenuBtn = document.querySelector('.mobile-menu');
const navLinks = document.querySelector('.nav-links');

mobileMenuBtn.addEventListener('click', () => {
    navLinks.style.display = navLinks.style.display === 'flex' ? 'none' : 'flex';
});

// Smooth Scrolling for Navigation Links
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
            target.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
            // Close mobile menu if open
            if (window.innerWidth <= 768) {
                navLinks.style.display = 'none';
            }
        }
    });
});

// Navbar Background Change on Scroll
const navbar = document.querySelector('.navbar');
window.addEventListener('scroll', () => {
    if (window.scrollY > 50) {
        navbar.style.background = 'rgba(255, 255, 255, 0.95)';
        navbar.style.boxShadow = '0 2px 5px rgba(0,0,0,0.1)';
    } else {
        navbar.style.background = 'var(--white)';
        navbar.style.boxShadow = 'none';
    }
});

// Form Submission Handler
function handleFormSubmit(event) {
    event.preventDefault();
    
    const form = document.getElementById('admissionForm');
    const submitButton = form.querySelector('button[type="submit"]');
    
    // Disable submit button and show loading state
    submitButton.disabled = true;
    submitButton.textContent = currentLang === 'en' ? 'Sending...' : 'पाठवत आहे...';
    
    const formData = new FormData(form);
    const templateParams = {
        from_name: formData.get('fullName'),
        from_email: formData.get('email'),
        phone: formData.get('phone'),
        program: formData.get('program'),
        message: formData.get('message'),
        to_name: 'Admin'  // Adding admin name for email template
    };

    // Send form data using Email.js
    emailjs.send(
        'service_3w8j3vp',
        'template_ftit8cu',
        templateParams
    )
    .then(function(response) {
        console.log('SUCCESS!', response.status, response.text);
        // Show success message
        alert(currentLang === 'en' ? 
            'Thank you for your application! We will contact you soon.' : 
            'तुमच्या अर्जासाठी धन्यवाद! आम्ही लवकरच तुमच्याशी संपर्क साधू.');
        form.reset();
    })
    .catch(function(error) {
        console.error('FAILED...', error);
        // Show error message
        alert(currentLang === 'en' ? 
            'Sorry, there was an error submitting your application. Please try again.' : 
            'क्षमस्व, तुमचा अर्ज सबमिट करताना त्रुटी आली. कृपया पुन्हा प्रयत्न करा.');
    })
    .finally(function() {
        // Re-enable submit button and restore text
        submitButton.disabled = false;
        submitButton.textContent = currentLang === 'en' ? 'Submit Application' : 'अर्ज सबमिट करा';
    });

    return false;
}

// Animate Elements on Scroll
const animateOnScroll = () => {
    const elements = document.querySelectorAll('.program-card, .stat-item, .about-content, .admission-form, .contact-info');
    
    elements.forEach(element => {
        const elementTop = element.getBoundingClientRect().top;
        const elementBottom = element.getBoundingClientRect().bottom;
        
        if (elementTop < window.innerHeight && elementBottom > 0) {
            element.style.opacity = '1';
            element.style.transform = 'translateY(0)';
        }
    });
};

// Initial animation check
window.addEventListener('load', animateOnScroll);
window.addEventListener('scroll', animateOnScroll);

// Add animation styles to elements
document.querySelectorAll('.program-card, .stat-item, .about-content, .admission-form, .contact-info').forEach(element => {
    element.style.opacity = '0';
    element.style.transform = 'translateY(20px)';
    element.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
});

// Image Slider
const slides = document.querySelectorAll('.slide');
const navBtns = document.querySelectorAll('.nav-btn');
let currentSlide = 0;
const slideInterval = 4000; // 4 seconds

function nextSlide() {
    // Remove active class from current slide and nav button
    slides[currentSlide].classList.remove('active');
    navBtns[currentSlide].classList.remove('active');
    
    // Move to next slide
    currentSlide = (currentSlide + 1) % slides.length;
    
    // Add active class to new slide and nav button
    slides[currentSlide].classList.add('active');
    navBtns[currentSlide].classList.add('active');
}

// Start automatic slideshow
let slideTimer = setInterval(nextSlide, slideInterval);

// Add click handlers for navigation buttons
navBtns.forEach((btn, index) => {
    btn.addEventListener('click', () => {
        // Clear the automatic timer
        clearInterval(slideTimer);
        
        // Remove active class from current slide and nav button
        slides[currentSlide].classList.remove('active');
        navBtns[currentSlide].classList.remove('active');
        
        // Set new current slide
        currentSlide = index;
        
        // Add active class to new slide and nav button
        slides[currentSlide].classList.add('active');
        navBtns[currentSlide].classList.add('active');
        
        // Restart the timer
        slideTimer = setInterval(nextSlide, slideInterval);
    });
});

// Visitor Counter functionality
function updateVisitorCount() {
    const visitorCountElement = document.querySelector('.visitor-count');
    if (!visitorCountElement) return;

    // Get the current count from localStorage
    let count = localStorage.getItem('visitorCount');
    
    // If no count exists, initialize it
    if (!count) {
        count = 0;
    }
    
    // Increment the count for new visits
    if (!localStorage.getItem('hasVisited')) {
        count = parseInt(count) + 1;
        localStorage.setItem('visitorCount', count);
        localStorage.setItem('hasVisited', 'true');
    }
    
    // Update the display
    visitorCountElement.textContent = count;
}

// Call the function when the page loads
document.addEventListener('DOMContentLoaded', function() {
    updateVisitorCount();
}); 